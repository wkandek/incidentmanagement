<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_2xn21wdnchsb-2>li:before{content:"\0025a0  "}ul.lst-kix_2xn21wdnchsb-8{list-style-type:none}ul.lst-kix_2xn21wdnchsb-7{list-style-type:none}.lst-kix_2xn21wdnchsb-3>li:before{content:"\0025cf  "}ul.lst-kix_2xn21wdnchsb-4{list-style-type:none}ul.lst-kix_2xn21wdnchsb-3{list-style-type:none}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}ul.lst-kix_2xn21wdnchsb-6{list-style-type:none}.lst-kix_2xn21wdnchsb-4>li:before{content:"\0025cb  "}ul.lst-kix_2xn21wdnchsb-5{list-style-type:none}ul.lst-kix_2xn21wdnchsb-0{list-style-type:none}ul.lst-kix_2xn21wdnchsb-2{list-style-type:none}ul.lst-kix_2xn21wdnchsb-1{list-style-type:none}.lst-kix_2xn21wdnchsb-5>li:before{content:"\0025a0  "}.lst-kix_2xn21wdnchsb-7>li:before{content:"\0025cb  "}.lst-kix_2xn21wdnchsb-6>li:before{content:"\0025cf  "}.lst-kix_2xn21wdnchsb-1>li:before{content:"\0025cb  "}.lst-kix_2xn21wdnchsb-8>li:before{content:"\0025a0  "}.lst-kix_2xn21wdnchsb-0>li:before{content:"\0025cf  "}ol{margin:0;padding:0}table td,table th{padding:0}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c2{color:#666666;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:12pt;font-family:"Arial";font-style:normal}.c8{color:#434343;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:14pt;font-family:"Arial";font-style:normal}.c4{padding-top:14pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c12{padding-top:16pt;padding-bottom:4pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c10{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;text-decoration:underline}.c9{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c7{padding:0;margin:0}.c11{color:inherit;text-decoration:inherit}.c6{margin-left:36pt;padding-left:0pt}.c5{margin-left:72pt;padding-left:0pt}.c3{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c9 doc-content"><h3 class="c12" id="h.60qih4jtdsoi"><span class="c8">Post-Mortem MMELK Outage November 2022 - incident-151</span></h3><h4 class="c4" id="h.i08ctoi0o4e1"><span class="c2">Description</span></h4><p class="c0"><span class="c1">On 2022-11-08 at 15:35 UTC the elasticsearch server (MMELK) for the Mobile Marketing (MM) system &nbsp;became inaccessible. SRE was notified by monitoring, an analysis showed showed that the disk for the short term ELK data had failed. A new disk was defined on an available external disk array, mounted and functionality restored at 22:47 UTC. Logging data for the last 7 days starting from 2022-11-01 11:34 UTC to 2022-11-08 15:37 UTC was lost. </span></p><p class="c0 c3"><span class="c1"></span></p><p class="c0"><span class="c1">The MMELK server has no Service Level Objective (SLO). Its main use is as a troubleshooting support tool. Customer support uses it to supply operational reports to three customers (cust533, cust 432 and cust342 with a combined revenue of &lt; 3M USD/year), but the reports are not under any Service Level Agreement</span></p><p class="c0 c3"><span class="c1"></span></p><h4 class="c4" id="h.frbjts94o0ti"><span class="c2">Priority</span></h4><p class="c0"><span class="c1">Initially P1, but downgraded to P3 when it became clear no customer facing reports were pending.</span></p><p class="c0 c3"><span class="c1"></span></p><h4 class="c4" id="h.gkxufuoo7x5c"><span class="c2">Detection</span></h4><p class="c0"><span class="c1">Monitoring for the index rate on MMELK alerted SRE to a problem with the indices on 2022-11-08 at 15:38 UTC. There were other, low level alerts as well. At around the same time (15:39 UTC) users in customer support complained about a problem using MMELK through an internal Slack channel. SRE called incident-151.</span></p><p class="c0 c3"><span class="c1"></span></p><h4 class="c4" id="h.hykxmnwluuas"><span class="c2">Mitigation</span></h4><p class="c0"><span class="c1">A new disk was formatted on a disk array that had space available and the disk was mounted via fibre channel. When MMELK was originally set up the local SSD disk was put in place to guarantee best performance. We will need to monitor for performance problems due to the different disk architecture. </span></p><p class="c0 c3"><span class="c1"></span></p><h4 class="c4" id="h.jll7ojo2fi1i"><span class="c2">Root Cause</span></h4><p class="c0"><span class="c1">The disk for the short term ELK data had been implemented as a software array using 6x HP SSD drives. The HP SSD drives came with a firmware defect that locked up the disk once 32678 operating hours were reached, a bit over 3.5 years. All 6 disks had the same defect and came from the same batch, locking up around the same time. All data on the disk was lost.</span></p><p class="c0"><span class="c1">HPE provides a firmware update to prevent the error from occurring. We did not install the firmware upgrade as we are not actively monitoring such updates.</span></p><p class="c0"><span class="c10"><a class="c11" href="https://www.google.com/url?q=https://support.hpe.com/hpesc/public/docDisplay?docId%3Demr_na-a00092491en_us&amp;sa=D&amp;source=editors&amp;ust=1682184480247844&amp;usg=AOvVaw310ulCQ9G9ZatgQcG0S_Eh">https://support.hpe.com/hpesc/public/docDisplay?docId=emr_na-a00092491en_us</a></span></p><p class="c0 c3"><span class="c1"></span></p><h4 class="c4" id="h.3ghlttq39f17"><span class="c2">Action Items</span></h4><ul class="c7 lst-kix_2xn21wdnchsb-0 start"><li class="c0 c6 li-bullet-0"><span class="c1">Audit other SSD drives for firmware issue - ticket OPS-3214: done 2022-11-09</span></li></ul><ul class="c7 lst-kix_2xn21wdnchsb-1 start"><li class="c0 c5 li-bullet-0"><span class="c1">2 drives found and fixed before 32678 hours over</span></li></ul><ul class="c7 lst-kix_2xn21wdnchsb-0"><li class="c0 c6 li-bullet-0"><span class="c1">Establish firmware update policy - ticket OPS-3216: done 2022-12-02</span></li></ul><ul class="c7 lst-kix_2xn21wdnchsb-1 start"><li class="c0 c5 li-bullet-0"><span class="c1">Firmware monitoring (disks, controllers, motherboard, dRAC/iLO, network cards) and installation falls to Infrastructure team and will be handled during normal quarterly patch window. A quarterly review for all devices is scheduled starting Q1 2023.</span></li></ul><ul class="c7 lst-kix_2xn21wdnchsb-0"><li class="c0 c6 li-bullet-0"><span class="c1">Review SLO for MMELK server - ticket OPS-3219: done - 2022-12-05</span></li></ul><ul class="c7 lst-kix_2xn21wdnchsb-1 start"><li class="c0 c5 li-bullet-0"><span class="c1">MMLEK needs to be 99% available, about 7 hours of downtime/month possible. This SLO requires a warm standby architecture. OPS-3304 filed for implementation. </span></li></ul></body></html>